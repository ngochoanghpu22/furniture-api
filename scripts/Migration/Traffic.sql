DECLARE
V_COUNT INTEGER;
BEGIN
SELECT COUNT(TABLE_NAME) INTO V_COUNT from USER_TABLES where TABLE_NAME = '__EFMigrationsHistory';
IF V_COUNT = 0 THEN
Begin
BEGIN 
EXECUTE IMMEDIATE 'CREATE TABLE 
"__EFMigrationsHistory" (
    "MIGRATION_ID" NVARCHAR2(150) NOT NULL,
    "PRODUCT_VERSION" NVARCHAR2(32) NOT NULL,
    CONSTRAINT "PK___EF_MIGRATIONS_HISTORY" PRIMARY KEY ("MIGRATION_ID")
)';
END;

End;

END IF;
EXCEPTION
WHEN OTHERS THEN
    IF(SQLCODE != -942)THEN
        RAISE;
    END IF;
END;
/

DECLARE
    v_Count INTEGER;
BEGIN
SELECT COUNT(*) INTO v_Count FROM "__EFMigrationsHistory" WHERE "MIGRATION_ID" = N'20220301110157_init_db';
IF v_Count = 0 THEN

    BEGIN 
    EXECUTE IMMEDIATE 'CREATE TABLE 
    "CARD_DELIVERY_INFO" (
        "ID" NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
        "PCID" VARCHAR2(32 CHAR),
        "POST_CODE" VARCHAR2(64 CHAR),
        "LAST_STATUS_CODE" VARCHAR2(32 CHAR),
        "ISSUED_CARD_DATE" TIMESTAMP(7) NOT NULL,
        "CARD_TYPE" VARCHAR2(32 CHAR),
        "TOTAL_FREIGHT_INCLUDE_VAT" BINARY_DOUBLE NOT NULL,
        "DELIVERY_START_DATE" TIMESTAMP(7),
        "DELIVERED_DATE" TIMESTAMP(7) NOT NULL,
        "ACCEPTANCE_POST_CODE" VARCHAR2(32 CHAR),
        "LAST_DESTINATION_POST_CODE" VARCHAR2(32 CHAR),
        "RECEIVER_NAME" NVARCHAR2(128),
        "RECEIVER_ADDRESS" NVARCHAR2(2000),
        "RECEIVER_TEL" VARCHAR2(32 CHAR),
        "WEIGHT" BINARY_FLOAT NOT NULL,
        "CREATED_DATE" TIMESTAMP(7) NOT NULL,
        "UPDATED_DATE" TIMESTAMP(7),
        "CREATED_BY" VARCHAR2(32 CHAR),
        "UPDATED_BY" VARCHAR2(32 CHAR),
        CONSTRAINT "PK_CARD_DELIVERY_INFO" PRIMARY KEY ("ID")
    )';
    END;
 END IF;
END;

/

DECLARE
    v_Count INTEGER;
BEGIN
SELECT COUNT(*) INTO v_Count FROM "__EFMigrationsHistory" WHERE "MIGRATION_ID" = N'20220301110157_init_db';
IF v_Count = 0 THEN

    BEGIN 
    EXECUTE IMMEDIATE 'CREATE TABLE 
    "CARD_TO_DELIVERY" (
        "ID" NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
        "PCID" VARCHAR2(32 CHAR) NOT NULL,
        "CARD_TYPE" VARCHAR2(32 CHAR) NOT NULL,
        "OPERATION_STATUS" NVARCHAR2(2000),
        "WARE_HOUSE_DATE" TIMESTAMP(7),
        "MANUFACTURED_DATE" TIMESTAMP(7) NOT NULL,
        "CREATED_DATE" TIMESTAMP(7) NOT NULL,
        "UPDATED_DATE" TIMESTAMP(7),
        "CREATED_BY" VARCHAR2(32 CHAR),
        "UPDATED_BY" VARCHAR2(32 CHAR),
        CONSTRAINT "PK_CARD_TO_DELIVERY" PRIMARY KEY ("ID")
    )';
    END;
 END IF;
END;

/

DECLARE
    v_Count INTEGER;
BEGIN
SELECT COUNT(*) INTO v_Count FROM "__EFMigrationsHistory" WHERE "MIGRATION_ID" = N'20220301110157_init_db';
IF v_Count = 0 THEN

    BEGIN 
    EXECUTE IMMEDIATE 'CREATE TABLE 
    "CARD_TO_MANUFACTURE" (
        "ID" NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
        "PCID" VARCHAR2(32 CHAR) NOT NULL,
        "CREATED_DATE" TIMESTAMP(7) NOT NULL,
        "UPDATED_DATE" TIMESTAMP(7),
        "CREATED_BY" VARCHAR2(32 CHAR),
        "UPDATED_BY" VARCHAR2(32 CHAR),
        CONSTRAINT "PK_CARD_TO_MANUFACTURE" PRIMARY KEY ("ID")
    )';
    END;
 END IF;
END;

/

DECLARE
    v_Count INTEGER;
BEGIN
SELECT COUNT(*) INTO v_Count FROM "__EFMigrationsHistory" WHERE "MIGRATION_ID" = N'20220301110157_init_db';
IF v_Count = 0 THEN

    BEGIN 
    EXECUTE IMMEDIATE 'CREATE TABLE 
    "CARD_TO_SAS" (
        "ID" NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
        "PCID" VARCHAR2(32 CHAR) NOT NULL,
        "POST_CODE" VARCHAR2(64 CHAR) NOT NULL,
        "CREATED_DATE" TIMESTAMP(7) NOT NULL,
        "UPDATED_DATE" TIMESTAMP(7),
        "CREATED_BY" VARCHAR2(32 CHAR),
        "UPDATED_BY" VARCHAR2(32 CHAR),
        CONSTRAINT "PK_CARD_TO_SAS" PRIMARY KEY ("ID")
    )';
    END;
 END IF;
END;

/

DECLARE
    v_Count INTEGER;
BEGIN
SELECT COUNT(*) INTO v_Count FROM "__EFMigrationsHistory" WHERE "MIGRATION_ID" = N'20220301110157_init_db';
IF v_Count = 0 THEN

    BEGIN 
    EXECUTE IMMEDIATE 'CREATE TABLE 
    "CARD_TO_SMS" (
        "ID" NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
        "PCID" VARCHAR2(32 CHAR),
        "POST_CODE" VARCHAR2(64 CHAR),
        "CONTRACT_NUMBER" VARCHAR2(32 CHAR),
        "PHONE_NUMBER" VARCHAR2(32 CHAR),
        "SENDING_STATUS" VARCHAR2(32 CHAR),
        "REMARK" NVARCHAR2(2000),
        "NEED_TO_SEND" NUMBER(1),
        "CREATED_DATE" TIMESTAMP(7) NOT NULL,
        "UPDATED_DATE" TIMESTAMP(7),
        "CREATED_BY" VARCHAR2(32 CHAR),
        "UPDATED_BY" VARCHAR2(32 CHAR),
        CONSTRAINT "PK_CARD_TO_SMS" PRIMARY KEY ("ID")
    )';
    END;
 END IF;
END;

/

DECLARE
    v_Count INTEGER;
BEGIN
SELECT COUNT(*) INTO v_Count FROM "__EFMigrationsHistory" WHERE "MIGRATION_ID" = N'20220301110157_init_db';
IF v_Count = 0 THEN

    BEGIN 
    EXECUTE IMMEDIATE 'CREATE TABLE 
    "CODE_LIST_STATUS" (
        "ID" NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
        "GROUP" VARCHAR2(512 CHAR),
        "CODE" VARCHAR2(32 CHAR),
        "NAME" NVARCHAR2(512),
        "DESCRIPTION" NVARCHAR2(2000),
        "IS_ACTIVE" NUMBER(1) NOT NULL,
        "CREATED_DATE" TIMESTAMP(7) NOT NULL,
        "UPDATED_DATE" TIMESTAMP(7),
        "CREATED_BY" VARCHAR2(32 CHAR),
        "UPDATED_BY" VARCHAR2(32 CHAR),
        CONSTRAINT "PK_CODE_LIST_STATUS" PRIMARY KEY ("ID")
    )';
    END;
 END IF;
END;

/

DECLARE
    v_Count INTEGER;
BEGIN
SELECT COUNT(*) INTO v_Count FROM "__EFMigrationsHistory" WHERE "MIGRATION_ID" = N'20220301110157_init_db';
IF v_Count = 0 THEN

    BEGIN 
    EXECUTE IMMEDIATE 'CREATE TABLE 
    "POST_OFFICE_LIST" (
        "ID" NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
        "POST_OFFICE_CODE" VARCHAR2(32 CHAR),
        "POST_OFFICE_NAME" NVARCHAR2(2000),
        "POST_OFFICE_TYPE" VARCHAR2(32 CHAR),
        "CENTER_CODE" VARCHAR2(32 CHAR),
        "PROVINCE_CODE" VARCHAR2(32 CHAR),
        CONSTRAINT "PK_POST_OFFICE_LIST" PRIMARY KEY ("ID")
    )';
    END;
 END IF;
END;

/

DECLARE
    v_Count INTEGER;
BEGIN
SELECT COUNT(*) INTO v_Count FROM "__EFMigrationsHistory" WHERE "MIGRATION_ID" = N'20220301110157_init_db';
IF v_Count = 0 THEN

    BEGIN 
    EXECUTE IMMEDIATE 'CREATE TABLE 
    "CARD_DELIVERY_STATUS" (
        "ID" NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
        "CARD_DELIVERY_INFO_ID" NUMBER(10) NOT NULL,
        "STATUS_CODE" VARCHAR2(32 CHAR),
        "DELIVERY_DATE" TIMESTAMP(7) NOT NULL,
        "DELIVERY_NOTE" NVARCHAR2(2000),
        "DESTINATION_POST_CODE" VARCHAR2(32 CHAR),
        "CREATED_DATE" TIMESTAMP(7) NOT NULL,
        "UPDATED_DATE" TIMESTAMP(7),
        "CREATED_BY" VARCHAR2(32 CHAR),
        "UPDATED_BY" VARCHAR2(32 CHAR),
        CONSTRAINT "PK_CARD_DELIVERY_STATUS" PRIMARY KEY ("ID"),
        CONSTRAINT "FK_CARD_DELIVERY_STATUS_CARD_DELIVERY_INFO_CARD_DELIVERY_INFO_ID" FOREIGN KEY ("CARD_DELIVERY_INFO_ID") REFERENCES "CARD_DELIVERY_INFO" ("ID") ON DELETE CASCADE
    )';
    END;
 END IF;
END;

/

DECLARE
    v_Count INTEGER;
BEGIN
SELECT COUNT(*) INTO v_Count FROM "__EFMigrationsHistory" WHERE "MIGRATION_ID" = N'20220301110157_init_db';
IF v_Count = 0 THEN

    BEGIN 
    EXECUTE IMMEDIATE 'CREATE TABLE 
    "SMS_LOG" (
        "ID" NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
        "CARD_TO_SMS_ID" NUMBER(10) NOT NULL,
        "MESSAGE_ID" VARCHAR2(128 CHAR),
        "SMS_STATUS" VARCHAR2(32 CHAR),
        "SMS_REMARK" NVARCHAR2(2000),
        "SMS_PROVIDER" VARCHAR2(32 CHAR),
        "SMS_SENDING_TIME" VARCHAR2(32 CHAR),
        "CREATED_DATE" TIMESTAMP(7) NOT NULL,
        "UPDATED_DATE" TIMESTAMP(7),
        "CREATED_BY" VARCHAR2(32 CHAR),
        "UPDATED_BY" VARCHAR2(32 CHAR),
        CONSTRAINT "PK_SMS_LOG" PRIMARY KEY ("ID"),
        CONSTRAINT "FK_SMS_LOG_CARD_TO_SMS_CARD_TO_SMS_ID" FOREIGN KEY ("CARD_TO_SMS_ID") REFERENCES "CARD_TO_SMS" ("ID") ON DELETE CASCADE
    )';
    END;
 END IF;
END;

/

DECLARE
    v_Count INTEGER;
BEGIN
SELECT COUNT(*) INTO v_Count FROM "__EFMigrationsHistory" WHERE "MIGRATION_ID" = N'20220301110157_init_db';
IF v_Count = 0 THEN

    EXECUTE IMMEDIATE '
    CREATE UNIQUE INDEX "IX_CARD_DELIVERY_INFO_PCID_POST_CODE" ON "CARD_DELIVERY_INFO" ("PCID", "POST_CODE")
    ';
 END IF;
END;

/

DECLARE
    v_Count INTEGER;
BEGIN
SELECT COUNT(*) INTO v_Count FROM "__EFMigrationsHistory" WHERE "MIGRATION_ID" = N'20220301110157_init_db';
IF v_Count = 0 THEN

    EXECUTE IMMEDIATE '
    CREATE INDEX "IX_CARD_DELIVERY_STATUS_CARD_DELIVERY_INFO_ID" ON "CARD_DELIVERY_STATUS" ("CARD_DELIVERY_INFO_ID")
    ';
 END IF;
END;

/

DECLARE
    v_Count INTEGER;
BEGIN
SELECT COUNT(*) INTO v_Count FROM "__EFMigrationsHistory" WHERE "MIGRATION_ID" = N'20220301110157_init_db';
IF v_Count = 0 THEN

    EXECUTE IMMEDIATE '
    CREATE UNIQUE INDEX "IX_CARD_TO_DELIVERY_ID_MANUFACTURED_DATE" ON "CARD_TO_DELIVERY" ("ID", "MANUFACTURED_DATE")
    ';
 END IF;
END;

/

DECLARE
    v_Count INTEGER;
BEGIN
SELECT COUNT(*) INTO v_Count FROM "__EFMigrationsHistory" WHERE "MIGRATION_ID" = N'20220301110157_init_db';
IF v_Count = 0 THEN

    EXECUTE IMMEDIATE '
    CREATE INDEX "IX_SMS_LOG_CARD_TO_SMS_ID" ON "SMS_LOG" ("CARD_TO_SMS_ID")
    ';
 END IF;
END;

/

DECLARE
    v_Count INTEGER;
BEGIN
SELECT COUNT(*) INTO v_Count FROM "__EFMigrationsHistory" WHERE "MIGRATION_ID" = N'20220301110157_init_db';
IF v_Count = 0 THEN

    EXECUTE IMMEDIATE '
    CREATE UNIQUE INDEX "IX_SMS_LOG_MESSAGE_ID" ON "SMS_LOG" ("MESSAGE_ID")
    ';
 END IF;
END;

/

DECLARE
    v_Count INTEGER;
BEGIN
SELECT COUNT(*) INTO v_Count FROM "__EFMigrationsHistory" WHERE "MIGRATION_ID" = N'20220301110157_init_db';
IF v_Count = 0 THEN

    EXECUTE IMMEDIATE '
    INSERT INTO "__EFMigrationsHistory" ("MIGRATION_ID", "PRODUCT_VERSION")
    VALUES (N''20220301110157_init_db'', N''5.0.11'')
    ';
 END IF;
END;

/

DECLARE
    v_Count INTEGER;
BEGIN
SELECT COUNT(*) INTO v_Count FROM "__EFMigrationsHistory" WHERE "MIGRATION_ID" = N'20220304054438_add_DisplayOrder_for_Code_List_Status';
IF v_Count = 0 THEN

    EXECUTE IMMEDIATE '
    ALTER TABLE "CODE_LIST_STATUS" ADD "DISPLAY_ORDER" NUMBER(10) DEFAULT 0 NOT NULL
    ';
 END IF;
END;

/

DECLARE
    v_Count INTEGER;
BEGIN
SELECT COUNT(*) INTO v_Count FROM "__EFMigrationsHistory" WHERE "MIGRATION_ID" = N'20220304054438_add_DisplayOrder_for_Code_List_Status';
IF v_Count = 0 THEN

    EXECUTE IMMEDIATE '
    INSERT INTO "__EFMigrationsHistory" ("MIGRATION_ID", "PRODUCT_VERSION")
    VALUES (N''20220304054438_add_DisplayOrder_for_Code_List_Status'', N''5.0.11'')
    ';
 END IF;
END;

/

